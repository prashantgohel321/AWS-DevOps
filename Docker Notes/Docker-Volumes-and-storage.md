# 🐳 Docker Volumes & Storage

## What is a Docker Volume?
A Docker Volume is a way **to persist data generated by and used in container**s. By default, when a container stops, crashes, or is deleted, its data is lost. <br >Volumes solve this problem by **binding container data to the host system**, so the data survives restarts and even container removal.

## Why Use Volumes?
Let’s say you're running a MySQL container. All data inside that container is stored in a path like /var/lib/mysql. If the container is removed, all data is lost. <br>To avoid this, you can mount a volume from your host to that directory, ensuring data persistence.

<br>

## Volume Types in Docker
| **Type**          | **Description**                                                          |
| ----------------- | ------------------------------------------------------------------------ |
| **Named Volumes** | Managed by Docker, created via `docker volume create`.                   |
| **Bind Mounts**   | You specify a path on the host machine to be mounted into the container. |

<br>

## Working with Volumes
### ✅ List Existing Volumes

```dockerfile
docker volume ls
```

### ✅ Create a Named Volume
```dockerfile
docker volume create mysql-data
```
### ✅ Check Volume Location on Host
```dockerfile
docker inspect mysql-data
```

> This shows the exact host path where Docker stores the volume's data.

### ✅ Run MySQL Container with Named Volume

```dockerfile
docker run --name mysql \
  --network two-tier \
  -v mysql-data:/var/lib/mysql \
  -e MYSQL_ROOT_PASSWORD=root \
  -e MYSQL_DATABASE=devops \
  mysql
```

`-v mysql-data:/var/lib/mysql` binds the container's data directory to the volume.

`/var/lib/mysql` is the default path inside the container where MySQL stores its data.

<br>

### 🔁 Restart Application Container (if needed)
```dockerfile
docker restart <app_container_id>
```

### 🧪 Test Persistence
1. Add some data inside MySQL.

2. Then stop and remove the MySQL container:
```dockerfile
docker stop <mysql_c_id> && docker rm <mysql_c_id>
```

3. Re-run the container with the same volume — your data will still be there!


<br>

## 🗂 Bind Mount (Manual Path-Based Volume)
You can also use a directory from your host file system instead of a named volume.

### ✅ Create Directory on Host
```dockerfile
mkdir -p /home/ubuntu/volumes/mysql
```

### ✅ Stop and Remove Existing Container
```dockerfile
docker stop <mysql_c_id> && docker rm <mysql_c_id>
```

### ✅ Run MySQL with Bind Mount
```dockerfile
docker run --name mysql \
  --network two-tier \
  -v /home/ubuntu/volumes/mysql:/var/lib/mysql \
  -e MYSQL_ROOT_PASSWORD=root \
  -e MYSQL_DATABASE=devops \
  mysql
```

> This approach gives direct control over the path and is often used in development environments.

<br>

## 📌 Summary: Docker Volume Best Practices
| **Use Case**                   | **Recommended Volume Type** |
| ------------------------------ | --------------------------- |
| Persistent database storage    | Named Volume or Bind Mount  |
| Local development with control | Bind Mount                  |
| Easy backup & portability      | Named Volume                |
